<!DOCTYPE html>
<html lang="bn">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>PDF Viewer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.16.105/pdf.min.js"></script>
    <style>
      html, body {
        margin: 0;
        height: 100%;
        background-color: #000;
        color: white;
        display: flex;
        flex-direction: column;
        font-family: "Noto Sans Bengali", sans-serif;
      }
      #toolbar {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: linear-gradient(90deg, #ff8a00, #e52e71);
        padding: 8px 12px;
        font-size: 16px;
      }
      #pdfCanvas {
        flex: 1;
        width: 100%;
        height: 100%;
        background: #000;
      }
      button {
        background: #fff;
        color: #000;
        border: none;
        padding: 6px 10px;
        border-radius: 6px;
        font-size: 15px;
        font-weight: 600;
      }
      button:active { opacity: 0.8; }
      #pageIndicator { margin: 0 10px; }
    </style>
  </head>
  <body>
    <div id="toolbar">
      <div>
        <button id="zoomOut">‚àí</button>
        <button id="zoomIn">+</button>
        <span id="pageIndicator">‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ 1 / 1</span>
      </div>
      <button id="toggleTheme">üåô</button>
    </div>
    <canvas id="pdfCanvas"></canvas>

    <script>
      const urlParams = new URLSearchParams(window.location.search);
      const pdfUrl = urlParams.get("file");
      const canvas = document.getElementById("pdfCanvas");
      const ctx = canvas.getContext("2d");
      const pageIndicator = document.getElementById("pageIndicator");

      let pdfDoc = null;
      let pageNum = 1;
      let scale = 1.2;
      let isDark = true;

      function renderPage(num) {
        pdfDoc.getPage(num).then(page => {
          const viewport = page.getViewport({ scale });
          canvas.height = viewport.height;
          canvas.width = viewport.width;
          const renderCtx = {
            canvasContext: ctx,
            viewport,
          };
          ctx.save();
          if (isDark) {
            ctx.fillStyle = "#000";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
          } else {
            ctx.fillStyle = "#fff";
            ctx.fillRect(0, 0, canvas.width, canvas.height);
          }
          ctx.restore();
          page.render(renderCtx);
          pageIndicator.textContent = `‡¶™‡ßÉ‡¶∑‡ßç‡¶†‡¶æ ${num} / ${pdfDoc.numPages}`;
        });
      }

      if (pdfUrl) {
        pdfjsLib.getDocument(pdfUrl).promise.then(pdf => {
          pdfDoc = pdf;
          renderPage(pageNum);
        });
      } else {
        alert("‚ùå ‡¶ï‡ßã‡¶®‡ßã PDF ‡¶´‡¶æ‡¶á‡¶≤ ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§");
      }

      document.getElementById("zoomIn").onclick = () => {
        scale += 0.2;
        renderPage(pageNum);
      };
      document.getElementById("zoomOut").onclick = () => {
        if (scale > 0.6) scale -= 0.2;
        renderPage(pageNum);
      };
      document.getElementById("toggleTheme").onclick = () => {
        isDark = !isDark;
        document.body.style.backgroundColor = isDark ? "#000" : "#fff";
        renderPage(pageNum);
      };
    </script>
  </body>
</html>